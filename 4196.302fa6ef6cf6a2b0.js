"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4196],{4196:(I,m,l)=>{l.r(m),l.d(m,{UserListPageModule:()=>F});var d=l(177),p=l(9417),s=l(5374),g=l(8498),h=l(6098),e=l(3953),u=l(5679);function f(o,c){if(1&o&&e.nrm(0,"ion-icon",21),2&o){const r=e.XpG();e.Y8G("name","asc"===r.sortDirection?"arrow-up":"arrow-down")}}function _(o,c){if(1&o&&e.nrm(0,"ion-icon",21),2&o){const r=e.XpG();e.Y8G("name","asc"===r.sortDirection?"arrow-up":"arrow-down")}}function x(o,c){if(1&o&&e.nrm(0,"ion-icon",21),2&o){const r=e.XpG();e.Y8G("name","asc"===r.sortDirection?"arrow-up":"arrow-down")}}function y(o,c){if(1&o&&(e.j41(0,"ion-text",22),e.EFF(1),e.k0s()),2&o){const r=e.XpG();e.R7$(),e.SpI(" Showing ",r.filteredUsers.length," members ")}}function b(o,c){1&o&&e.nrm(0,"ion-spinner")}function C(o,c){if(1&o&&(e.j41(0,"ion-text",23),e.EFF(1),e.k0s()),2&o){const r=e.XpG();e.R7$(),e.JRh(r.error)}}function P(o,c){if(1&o&&(e.j41(0,"ion-card",24)(1,"ion-card-header")(2,"div",25)(3,"ion-card-title"),e.EFF(4),e.j41(5,"small",26),e.EFF(6),e.k0s()()()(),e.j41(7,"ion-card-content",27)(8,"div",28)(9,"div"),e.EFF(10),e.k0s(),e.j41(11,"div"),e.EFF(12),e.k0s(),e.j41(13,"div"),e.EFF(14),e.k0s()()()()),2&o){const r=c.$implicit,n=e.XpG();e.Y8G("ngClass",n.getMembershipStatus(r.expiryDate)),e.R7$(4),e.SpI("",r.name," "),e.R7$(2),e.SpI("ID: ",r.userId,""),e.R7$(4),e.JRh(r.address||"No address"),e.R7$(2),e.JRh(r.phoneNumber||"No phone"),e.R7$(2),e.SpI("Expires: ",n.formatDate(r.expiryDate),"")}}function M(o,c){1&o&&(e.j41(0,"p"),e.EFF(1,"Try adjusting your search criteria"),e.k0s())}function D(o,c){1&o&&(e.j41(0,"p"),e.EFF(1,"Add new members to see them listed here"),e.k0s())}function O(o,c){if(1&o&&(e.j41(0,"div",29),e.nrm(1,"ion-icon",30),e.j41(2,"h3"),e.EFF(3,"No members found"),e.k0s(),e.DNE(4,M,2,0,"p",15)(5,D,2,0,"p",15),e.j41(6,"ion-button",31),e.EFF(7,"Add Member"),e.k0s()()),2&o){const r=e.XpG();e.R7$(4),e.Y8G("ngIf",r.searchTerm),e.R7$(),e.Y8G("ngIf",!r.searchTerm)}}const U=[{path:"",component:(()=>{var o;class c{constructor(n,t,i){this.gymManagementService=n,this.router=t,this.route=i,this.users=[],this.filteredUsers=[],this.searchTerm="",this.sortOption="name",this.sortDirection="asc",this.selectedSegment="all",this.gymId=null,this.loading=!1,this.error=null,this.DateUtils=h.E}ngOnInit(){this.gymId=this.route.snapshot.queryParamMap.get("gymId"),this.gymId||(this.gymId=localStorage.getItem("gymId")),this.fetchAllUsers()}ionViewWillEnter(){this.gymId?this.fetchAllUsers():this.router.navigate(["/settings"])}fetchAllUsers(){if(this.loading=!0,this.error=null,!this.gymId)return this.error="No gym ID found",void(this.loading=!1);this.gymManagementService.getAllUsers(this.gymId).subscribe({next:n=>{this.loading=!1,console.log("Fetched Users:",n),this.users=n.map(t=>({userId:t.UserId,name:t.Name,phoneNumber:t.PhoneNumber,email:t.Email,dateOfBirth:t.DateOfBirth,gender:t.Gender,address:t.Address,emergencyContact:t.EmegencyContact,createdDate:t.CreatedDate,expiryDate:t.ExpiryDate,updatedDate:t.UpdatedDate,expiresInDays:this.calculateExpiryInDays(t.ExpiryDate)})),this.filteredUsers=[...this.users],this.sortUsers()},error:n=>{this.loading=!1,this.error="Error fetching users",console.error("Error fetching users:",n),console.log("Authentication error. Redirecting to settings page."),this.router.navigate(["/settings"])}})}calculateExpiryInDays(n){const t=new Date,a=new Date(n).getTime()-t.getTime();return Math.ceil(a/864e5)}filterUsers(){let n=[...this.users];if(this.searchTerm.trim()){const t=this.searchTerm.toLowerCase().trim();n=n.filter(i=>i.name.toLowerCase().includes(t)||i.phoneNumber.includes(t)||i.email&&i.email.toLowerCase().includes(t)||i.address&&i.address.toLowerCase().includes(t))}"all"!==this.selectedSegment&&(n=n.filter(t=>{const i=this.getMembershipStatus(t.expiryDate);return"active"===this.selectedSegment&&"active"===i||"expiring"===this.selectedSegment&&"expiring-soon"===i||"expired"===this.selectedSegment&&"expired"===i})),this.filteredUsers=n,this.sortUsers()}segmentChanged(n){this.selectedSegment=n.detail.value,this.filterUsers()}sortUsers(){this.filteredUsers.sort((n,t)=>{let i,a;switch(this.sortOption){case"name":default:i=n.name.toLowerCase(),a=t.name.toLowerCase();break;case"expiryDate":i=new Date(this.convertToDateFormat(n.expiryDate)).getTime(),a=new Date(this.convertToDateFormat(t.expiryDate)).getTime();break;case"createdDate":i=new Date(this.convertToDateFormat(n.createdDate)).getTime(),a=new Date(this.convertToDateFormat(t.createdDate)).getTime()}return"asc"===this.sortDirection?i>a?1:-1:i<a?1:-1})}changeSortOption(n){this.sortOption===n?this.sortDirection="asc"===this.sortDirection?"desc":"asc":(this.sortOption=n,this.sortDirection="asc"),this.sortUsers()}formatDate(n){if(!n)return"N/A";const t=n.split("/");if(3===t.length)return new Date(`${t[2]}-${t[1]}-${t[0]}`).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});try{return new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return n}}getRemainingDays(n){if(!n)return 0;const t=new Date(this.convertToDateFormat(n)),i=new Date,a=t.getTime()-i.getTime();return Math.ceil(a/864e5)}convertToDateFormat(n){const t=n.split("/");return 3!==t.length?n:`${t[2]}-${t[1]}-${t[0]}`}getMembershipStatus(n){const t=this.getRemainingDays(n);return t<=0?"expired":t<=7?"expiring-soon":"active"}}return(o=c).\u0275fac=function(n){return new(n||o)(e.rXU(u.q),e.rXU(g.Ix),e.rXU(g.nX))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-user-list"]],decls:48,vars:16,consts:[["color","primary"],["slot","end"],["routerLink","/register-user"],["slot","icon-only","name","add-outline"],["placeholder","Search by name, phone, or address...",3,"ngModelChange","ionChange","ngModel"],["color","primary",3,"ngModelChange","ionChange","ngModel"],["value","all"],["value","active"],["value","expiring"],["value","expired"],[1,"sort-controls"],[3,"click"],[3,"name",4,"ngIf"],[1,"results-count"],["color","medium",4,"ngIf"],[4,"ngIf"],["color","danger",4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["name","person-add-outline"],[3,"name"],["color","medium"],["color","danger"],[3,"ngClass"],[2,"display","flex","justify-content","space-between","align-items","center"],[2,"font-size","0.6em","opacity","0.7"],[1,"compact-content"],[1,"contact-info"],[1,"empty-state"],["name","people-outline","size","large"],["expand","block","routerLink","/register-user"]],template:function(n,t){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3,"Members List"),e.k0s(),e.j41(4,"ion-buttons",1)(5,"ion-button",2),e.nrm(6,"ion-icon",3),e.k0s()()(),e.j41(7,"ion-toolbar")(8,"ion-searchbar",4),e.mxI("ngModelChange",function(a){return e.DH7(t.searchTerm,a)||(t.searchTerm=a),a}),e.bIt("ionChange",function(){return t.filterUsers()}),e.k0s()(),e.j41(9,"ion-toolbar")(10,"ion-segment",5),e.mxI("ngModelChange",function(a){return e.DH7(t.selectedSegment,a)||(t.selectedSegment=a),a}),e.bIt("ionChange",function(a){return t.segmentChanged(a)}),e.j41(11,"ion-segment-button",6)(12,"ion-label"),e.EFF(13,"All"),e.k0s()(),e.j41(14,"ion-segment-button",7)(15,"ion-label"),e.EFF(16,"Active"),e.k0s()(),e.j41(17,"ion-segment-button",8)(18,"ion-label"),e.EFF(19,"Expiring"),e.k0s()(),e.j41(20,"ion-segment-button",9)(21,"ion-label"),e.EFF(22,"Expired"),e.k0s()()()()(),e.j41(23,"ion-content")(24,"div",10)(25,"ion-label"),e.EFF(26,"Sort by:"),e.k0s(),e.j41(27,"ion-chip",11),e.bIt("click",function(){return t.changeSortOption("name")}),e.j41(28,"ion-label"),e.EFF(29,"Name"),e.k0s(),e.DNE(30,f,1,1,"ion-icon",12),e.k0s(),e.j41(31,"ion-chip",11),e.bIt("click",function(){return t.changeSortOption("expiryDate")}),e.j41(32,"ion-label"),e.EFF(33,"Expiry Date"),e.k0s(),e.DNE(34,_,1,1,"ion-icon",12),e.k0s(),e.j41(35,"ion-chip",11),e.bIt("click",function(){return t.changeSortOption("createdDate")}),e.j41(36,"ion-label"),e.EFF(37,"Join Date"),e.k0s(),e.DNE(38,x,1,1,"ion-icon",12),e.k0s()(),e.j41(39,"div",13),e.DNE(40,y,2,1,"ion-text",14)(41,b,1,0,"ion-spinner",15)(42,C,2,1,"ion-text",16),e.k0s(),e.DNE(43,P,15,6,"ion-card",17)(44,O,8,2,"div",18),e.j41(45,"ion-fab",19)(46,"ion-fab-button",2),e.nrm(47,"ion-icon",20),e.k0s()()()),2&n&&(e.R7$(8),e.R50("ngModel",t.searchTerm),e.R7$(2),e.R50("ngModel",t.selectedSegment),e.R7$(17),e.AVh("active","name"===t.sortOption),e.R7$(3),e.Y8G("ngIf","name"===t.sortOption),e.R7$(),e.AVh("active","expiryDate"===t.sortOption),e.R7$(3),e.Y8G("ngIf","expiryDate"===t.sortOption),e.R7$(),e.AVh("active","createdDate"===t.sortOption),e.R7$(3),e.Y8G("ngIf","createdDate"===t.sortOption),e.R7$(2),e.Y8G("ngIf",!t.loading),e.R7$(),e.Y8G("ngIf",t.loading),e.R7$(),e.Y8G("ngIf",t.error),e.R7$(),e.Y8G("ngForOf",t.filteredUsers),e.R7$(),e.Y8G("ngIf",0===t.filteredUsers.length&&!t.loading))},dependencies:[d.YU,d.Sq,d.bT,p.BC,p.vS,s.Jm,s.QW,s.b_,s.I9,s.ME,s.tN,s.ZB,s.W9,s.Q8,s.YW,s.eU,s.iq,s.he,s.S1,s.Gp,s.eP,s.w2,s.IO,s.BC,s.ai,s.Je,s.Gw,s.N7,g.Wk],styles:["ion-content[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px;--padding-top: 16px}.sort-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px;overflow-x:auto;padding-bottom:8px}.sort-controls[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:14px;color:var(--ion-color-medium);white-space:nowrap}.sort-controls[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{height:28px;font-size:12px}.sort-controls[_ngcontent-%COMP%]   ion-chip.active[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);color:#fff}.results-count[_ngcontent-%COMP%]{margin-bottom:12px;font-size:14px;display:flex;align-items:center;gap:8px}ion-card[_ngcontent-%COMP%]{margin-bottom:10px;border-radius:8px;box-shadow:0 2px 6px #0000001a}ion-card.expired[_ngcontent-%COMP%]{border-left:4px solid var(--ion-color-danger)}ion-card.expiring-soon[_ngcontent-%COMP%]{border-left:4px solid var(--ion-color-warning)}ion-card.active[_ngcontent-%COMP%]{border-left:4px solid var(--ion-color-success)}ion-card-header[_ngcontent-%COMP%]{padding:10px 16px 0}ion-card-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:0}.contact-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;font-size:14px}.contact-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{line-height:1.3}.compact-content[_ngcontent-%COMP%]{padding:0 16px 12px}.label-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--ion-color-medium);margin-bottom:4px}ion-grid[_ngcontent-%COMP%]{padding:0}ion-row[_ngcontent-%COMP%]{margin-bottom:12px}.membership-info[_ngcontent-%COMP%]{background-color:rgba(var(--ion-color-light-rgb),.5);border-radius:8px;padding:8px;margin-top:8px}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-around;margin-top:16px;padding-top:16px;border-top:1px solid var(--ion-color-light)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:48px 16px}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--ion-color-medium);margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin:0 0 8px;color:var(--ion-color-dark)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0 0 24px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{max-width:200px}@media (max-width: 576px){ion-content[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px}ion-card-title[_ngcontent-%COMP%]{font-size:16px}ion-card-content[_ngcontent-%COMP%]{padding:12px}.label-title[_ngcontent-%COMP%]{font-size:12px}p[_ngcontent-%COMP%]{font-size:13px;margin:0}ion-button[_ngcontent-%COMP%]{font-size:12px}ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.action-buttons[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px}}"]}),c})()}];let v=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.iI.forChild(U),g.iI]}),c})(),F=(()=>{var o;class c{}return(o=c).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[d.MD,p.YN,s.bv,v]}),c})()}}]);