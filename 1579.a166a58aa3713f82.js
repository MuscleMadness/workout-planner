"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1579],{1579:(j,p,a)=>{a.r(p),a.d(p,{SettingsPageModule:()=>R});var S=a(177),m=a(9417),s=a(5374),d=a(8498),h=a(467);const f=(0,a(5083).F3)("SocialLogin",{web:()=>a.e(7246).then(a.bind(a,7246)).then(o=>new o.SocialLoginWeb)});var I=a(5312),e=a(3953),y=a(4909),P=a(5468),L=a(2872),b=a(5679);function F(o,g){if(1&o){const l=e.RV6();e.j41(0,"ion-button",8),e.bIt("click",function(){e.eBV(l);const t=e.XpG(2);return e.Njj(t.openDashboard())}),e.EFF(1," Dashboard "),e.k0s()}}function M(o,g){if(1&o&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-card-subtitle"),e.EFF(5),e.k0s()(),e.j41(6,"ion-card-content"),e.DNE(7,F,2,0,"ion-button",7),e.k0s()()),2&o){const l=e.XpG();e.R7$(3),e.JRh(l.userInfo.name),e.R7$(2),e.JRh(l.userInfo.email),e.R7$(2),e.Y8G("ngIf",l.showDashboardButton)}}const C=[{path:"",component:(()=>{var o;class g{constructor(n,t,i,r,c,u){this.translateService=n,this.appComponent=t,this.platform=i,this.route=r,this.router=c,this.gymManagementService=u,this.gymId=null,this.isLoggedIn=!1,this.userInfo=null,this.showDashboardButton=!1,this.selectedLanguage=this.translateService.currentLang,this.initializeApp()}ngOnInit(){this.gymId=this.route.snapshot.queryParamMap.get("gymId"),this.gymId||(this.gymId=localStorage.getItem("gymId"))}initializeApp(){this.platform.ready().then((0,h.A)(function*(){yield f.initialize({google:{webClientId:I.c.googleSignInClientId}})}))}ionViewWillEnter(){this.loadSessionDetails()}loadSessionDetails(){this.isLoggedIn=!!localStorage.getItem("authToken");const t=localStorage.getItem("authResult");if(t){const r=JSON.parse(t);this.userInfo={name:r.profile.name,phoneNumber:"",email:r.profile.email,dateOfBirth:"",gender:"Male",address:"",emergencyContact:"",expiryDate:"",createdDate:"",userId:0}}else this.userInfo=null;var i=localStorage.getItem("role");console.log("Access Level:",i),this.showDashboardButton=!!i&&("owner"===i||"editor"===i||"viewer"===i)}removeQueryParams(){localStorage.setItem("queryParams",JSON.stringify(this.route.snapshot.queryParams)),this.router.navigate([],{replaceUrl:!0})}restoreQueryParams(){const n=localStorage.getItem("queryParams");if(n){const t=JSON.parse(n);this.router.navigate([],{queryParams:t,replaceUrl:!0})}}login(){var n=this;return(0,h.A)(function*(){n.removeQueryParams();const t=yield f.login({provider:"google",options:{scopes:["email","profile"]}});if(n.restoreQueryParams(),"google"===t.provider){var i,r,c;const u=t.result;localStorage.setItem("authToken",null!==(i=null==u?void 0:u.idToken)&&void 0!==i?i:""),localStorage.setItem("authResult",JSON.stringify(u)),n.getUserPermissions(null!==(r=null==u||null===(c=u.profile)||void 0===c?void 0:c.email)&&void 0!==r?r:"")}})()}getUserPermissions(n){this.gymManagementService.getUserPermissions("Gym20251",n).subscribe({next:t=>{console.log("User permissions:",t),localStorage.setItem("role",t.accessLevel),this.loadSessionDetails()},error:t=>{console.error("Error fetching user permissions:",t),localStorage.setItem("role",""),this.loadSessionDetails()}})}openDashboard(){this.router.navigate(["/dashboard"],{})}logout(){var n=this;return(0,h.A)(function*(){yield f.logout({provider:"apple"}),localStorage.removeItem("authToken"),localStorage.removeItem("authResult"),n.loadSessionDetails()})()}changeLanguage(n){this.appComponent.switchLanguage(n.detail.value)}}return(o=g).\u0275fac=function(n){return new(n||o)(e.rXU(y.c$),e.rXU(P.Z),e.rXU(L.OD),e.rXU(d.nX),e.rXU(d.Ix),e.rXU(b.q))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-settings"]],decls:20,vars:3,consts:[[1,"ion-no-border"],["slot","start"],["slot","end","fill","clear",3,"click"],[4,"ngIf"],[3,"ngModelChange","ionChange","ngModel"],["value","en"],["value","ta"],["expand","full",3,"click",4,"ngIf"],["expand","full",3,"click"]],template:function(n,t){1&n&&(e.j41(0,"ion-content")(1,"ion-header",0)(2,"ion-toolbar")(3,"ion-buttons",1),e.nrm(4,"ion-menu-button"),e.k0s(),e.j41(5,"ion-title")(6,"h3"),e.EFF(7,"Settings"),e.k0s()(),e.j41(8,"ion-button",2),e.bIt("click",function(){return t.isLoggedIn?t.logout():t.login()}),e.EFF(9),e.k0s()()(),e.j41(10,"ion-content"),e.DNE(11,M,8,3,"ion-card",3),e.j41(12,"ion-item")(13,"ion-label"),e.EFF(14,"Language"),e.k0s(),e.j41(15,"ion-select",4),e.mxI("ngModelChange",function(r){return e.DH7(t.selectedLanguage,r)||(t.selectedLanguage=r),r}),e.bIt("ionChange",function(r){return t.changeLanguage(r)}),e.j41(16,"ion-select-option",5),e.EFF(17,"English"),e.k0s(),e.j41(18,"ion-select-option",6),e.EFF(19,"\u0ba4\u0bae\u0bbf\u0bb4\u0bcd"),e.k0s()()()()()),2&n&&(e.R7$(9),e.SpI(" ",t.isLoggedIn?"Logout":"Login"," "),e.R7$(2),e.Y8G("ngIf",t.userInfo),e.R7$(4),e.R50("ngModel",t.selectedLanguage))},dependencies:[S.bT,m.BC,m.vS,s.Jm,s.QW,s.b_,s.I9,s.ME,s.HW,s.tN,s.W9,s.eU,s.uz,s.he,s.MC,s.Nm,s.Ip,s.BC,s.ai,s.Je]}),g})()}];let D=(()=>{var o;class g{}return(o=g).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[d.iI.forChild(C),d.iI]}),g})(),R=(()=>{var o;class g{}return(o=g).\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[S.MD,m.YN,s.bv,D]}),g})()}}]);