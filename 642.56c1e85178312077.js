"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[642],{642:(j,h,l)=>{l.r(h),l.d(h,{RegisterUserPageModule:()=>F});var c=l(177),u=l(9417),n=l(5374),m=l(8498),e=l(3953),f=l(5679);const p=["dobPicker"];function R(s,a){1&s&&e.nrm(0,"ion-spinner")}function y(s,a){if(1&s&&(e.j41(0,"ion-card")(1,"ion-card-content")(2,"ion-text",23),e.EFF(3),e.k0s()()()),2&s){const g=e.XpG();e.R7$(3),e.JRh(g.error)}}function b(s,a){if(1&s&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3),e.k0s(),e.j41(4,"ion-card-subtitle"),e.EFF(5),e.k0s()()()),2&s){const g=e.XpG();e.R7$(3),e.JRh(g.gymInfo.name),e.R7$(2),e.JRh(g.gymInfo.address)}}function I(s,a){1&s&&e.nrm(0,"ion-datetime",24,1)}const M=[{path:"",component:(()=>{var s;class a{constructor(t,r,o,d){this.route=t,this.router=r,this.gymManagementService=o,this.cdr=d,this.gymId=null,this.gymInfo=null,this.loading=!1,this.error=null,this.userId=null,this.user={userId:0,name:"",phoneNumber:"",email:"",dateOfBirth:"",gender:"Male",address:"",emergencyContact:"",expiryDate:"",createdDate:""}}ngOnInit(){var t;this.gymId=this.route.snapshot.queryParamMap.get("gymId"),this.gymId||(this.gymId=localStorage.getItem("gymId")),this.gymId&&this.getGymInfo();const r=this.router.getCurrentNavigation();null!=r&&null!==(t=r.extras.state)&&void 0!==t&&t.user&&(this.user=r.extras.state.user,console.log("User object received:",this.user),this.userId=String(this.user.userId),this.cdr.detectChanges())}getGymInfo(){this.gymId?(this.loading=!0,this.error=null,this.gymManagementService.getGymInfo(this.gymId).subscribe({next:t=>{console.log(t),t.success?this.gymInfo=t.gymInfo:this.error="Failed to fetch gym details",this.loading=!1},error:t=>{this.error="An error occurred while fetching gym details",console.error(t),this.loading=!1}})):this.error="Gym ID not found in URL"}loadUserDetails(t){this.loading=!0,this.error="",this.gymManagementService.getUserInfo(this.gymId,this.userId).subscribe(r=>{console.log(r),this.loading=!1,"success"===r.status?this.user=r.user:this.error="User not found"},r=>{console.log(r),this.loading=!1,this.error="Failed to fetch user details"})}submitForm(){this.user.name&&this.user.phoneNumber?(this.dobPicker&&(this.user.dateOfBirth="string"==typeof this.dobPicker.value?this.dobPicker.value:""),console.log("User Data:",this.user),this.loading=!0,this.error=null,this.userId?this.updateUser():this.registerUser()):this.error="Name and Phone Number are mandatory."}updateUser(){this.gymManagementService.updateUser(this.gymId,this.user).subscribe({next:t=>{this.loading=!1,console.log("User data successfully:",t),this.router.navigate(["/dashboard"])},error:t=>{this.loading=!1,this.error="Failed to save user. Please try again.",console.error("Error while saving user data:",t)}})}registerUser(){this.gymManagementService.registerUser(this.gymId,this.user).subscribe({next:t=>{this.loading=!1,console.log("User registered successfully:",t),this.router.navigate(["/membership"],{queryParams:{gymId:this.gymId,phoneNumber:t.phoneNumber}}).then(()=>{window.location.reload()})},error:t=>{this.loading=!1,this.error="Failed to register user. Please try again.",console.error("Registration error:",t)}})}}return(s=a).\u0275fac=function(t){return new(t||s)(e.rXU(m.nX),e.rXU(m.Ix),e.rXU(f.q),e.rXU(e.gRc))},s.\u0275cmp=e.VBU({type:s,selectors:[["app-register-user"]],viewQuery:function(t,r){if(1&t&&e.GBs(p,5),2&t){let o;e.mGM(o=e.lsd())&&(r.dobPicker=o.first)}},decls:58,vars:13,consts:[["registerForm","ngForm"],["dobPicker",""],["slot","start"],["defaultHref","/membership"],[4,"ngIf"],[3,"ngSubmit"],["position","floating"],["type","text","required","","name","name",3,"ngModelChange","ngModel"],["type","tel","required","","name","phoneNumber",3,"ngModelChange","ngModel"],["datetime","dob-datetime","presentation","date"],[3,"keepContentsMounted"],["value","optional"],["slot","header"],["slot","content"],["name","gender",3,"ngModelChange","ngModel"],["value","Male"],["value","Female"],["value","Other"],["type","email","name","email",3,"ngModelChange","ngModel"],["name","address",3,"ngModelChange","ngModel"],["type","tel","name","emergencyContact",3,"ngModelChange","ngModel"],[1,"button-container"],["expand","block","color","primary","type","submit",3,"disabled"],["color","danger"],["id","dob-datetime","presentation","date","name","dob"]],template:function(t,r){if(1&t){const o=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",2),e.nrm(3,"ion-back-button",3),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,R,1,0,"ion-spinner",4)(8,y,4,1,"ion-card",4)(9,b,6,2,"ion-card",4),e.j41(10,"form",5,0),e.bIt("ngSubmit",function(){return e.eBV(o),e.Njj(r.submitForm())}),e.j41(12,"ion-list")(13,"ion-item")(14,"ion-label",6),e.EFF(15,"Name *"),e.k0s(),e.j41(16,"ion-input",7),e.mxI("ngModelChange",function(i){return e.eBV(o),e.DH7(r.user.name,i)||(r.user.name=i),e.Njj(i)}),e.k0s()(),e.j41(17,"ion-item")(18,"ion-label",6),e.EFF(19,"Phone Number *"),e.k0s(),e.j41(20,"ion-input",8),e.mxI("ngModelChange",function(i){return e.eBV(o),e.DH7(r.user.phoneNumber,i)||(r.user.phoneNumber=i),e.Njj(i)}),e.k0s()(),e.j41(21,"ion-item")(22,"ion-label"),e.EFF(23,"Date of Birth"),e.k0s(),e.nrm(24,"ion-datetime-button",9),e.j41(25,"ion-modal",10),e.DNE(26,I,2,0,"ng-template"),e.k0s()(),e.j41(27,"ion-accordion-group")(28,"ion-accordion",11)(29,"ion-item",12)(30,"ion-label"),e.EFF(31,"Optional Details"),e.k0s()(),e.j41(32,"div",13)(33,"ion-item")(34,"ion-label",6),e.EFF(35,"Gender"),e.k0s(),e.j41(36,"ion-select",14),e.mxI("ngModelChange",function(i){return e.eBV(o),e.DH7(r.user.gender,i)||(r.user.gender=i),e.Njj(i)}),e.j41(37,"ion-select-option",15),e.EFF(38,"Male"),e.k0s(),e.j41(39,"ion-select-option",16),e.EFF(40,"Female"),e.k0s(),e.j41(41,"ion-select-option",17),e.EFF(42,"Other"),e.k0s()()(),e.j41(43,"ion-item")(44,"ion-label",6),e.EFF(45,"Email"),e.k0s(),e.j41(46,"ion-input",18),e.mxI("ngModelChange",function(i){return e.eBV(o),e.DH7(r.user.email,i)||(r.user.email=i),e.Njj(i)}),e.k0s()(),e.j41(47,"ion-item")(48,"ion-label",6),e.EFF(49,"Address"),e.k0s(),e.j41(50,"ion-textarea",19),e.mxI("ngModelChange",function(i){return e.eBV(o),e.DH7(r.user.address,i)||(r.user.address=i),e.Njj(i)}),e.k0s()(),e.j41(51,"ion-item")(52,"ion-label",6),e.EFF(53,"Emergency Contact"),e.k0s(),e.j41(54,"ion-input",20),e.mxI("ngModelChange",function(i){return e.eBV(o),e.DH7(r.user.emergencyContact,i)||(r.user.emergencyContact=i),e.Njj(i)}),e.k0s()()()()()(),e.j41(55,"div",21)(56,"ion-button",22),e.EFF(57),e.k0s()()()()}if(2&t){const o=e.sdS(11);e.R7$(5),e.SpI(" ",r.userId?"Edit":"Register",""),e.R7$(2),e.Y8G("ngIf",r.loading),e.R7$(),e.Y8G("ngIf",r.error),e.R7$(),e.Y8G("ngIf",r.gymInfo),e.R7$(7),e.R50("ngModel",r.user.name),e.R7$(4),e.R50("ngModel",r.user.phoneNumber),e.R7$(5),e.Y8G("keepContentsMounted",!0),e.R7$(11),e.R50("ngModel",r.user.gender),e.R7$(10),e.R50("ngModel",r.user.email),e.R7$(4),e.R50("ngModel",r.user.address),e.R7$(4),e.R50("ngModel",r.user.emergencyContact),e.R7$(2),e.Y8G("disabled",!o.form.valid),e.R7$(),e.SpI(" ",r.userId?"Save":"Register","")}},dependencies:[c.bT,u.qT,u.BC,u.cb,u.YS,u.vS,u.cV,n.xk,n.YH,n.Jm,n.QW,n.b_,n.I9,n.ME,n.HW,n.tN,n.W9,n.A9,n.K4,n.eU,n.$w,n.uz,n.he,n.nf,n.Nm,n.Ip,n.w2,n.IO,n.nc,n.BC,n.ai,n.Sb,n.Je,n.Gw,n.el]}),a})()}];let U=(()=>{var s;class a{}return(s=a).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[m.iI.forChild(M),m.iI]}),a})(),F=(()=>{var s;class a{}return(s=a).\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.$C({type:s}),s.\u0275inj=e.G2t({imports:[c.MD,u.YN,n.bv,U]}),a})()}}]);