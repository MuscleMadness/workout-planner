"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6658],{6658:(P,c,i)=>{i.r(c),i.d(c,{DashboardPageModule:()=>I});var l=i(177),h=i(9417),o=i(5374),d=i(8498),u=i(6098),e=i(3953),m=i(5679);function f(r,s){1&r&&e.nrm(0,"ion-spinner")}function p(r,s){if(1&r&&(e.j41(0,"ion-card")(1,"ion-card-content")(2,"ion-text",3),e.EFF(3),e.k0s()()()),2&r){const n=e.XpG();e.R7$(3),e.JRh(n.error)}}function y(r,s){if(1&r){const n=e.RV6();e.j41(0,"ion-item",4),e.bIt("click",function(){const a=e.eBV(n).$implicit,g=e.XpG();return e.Njj(g.openUserDetails(a))}),e.j41(1,"ion-label")(2,"h2"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s(),e.j41(6,"p",5),e.EFF(7),e.k0s()()()}if(2&r){const n=s.$implicit,t=e.XpG();e.R7$(3),e.JRh(n.name),e.R7$(2),e.JRh(n.phoneNumber),e.R7$(),e.Y8G("ngStyle",t.DateUtils.getExpiryStyle(n.expiresInDays)),e.R7$(),e.JRh(t.DateUtils.getExpiryStatus(n.expiresInDays))}}const D=[{path:"",component:(()=>{var r;class s{constructor(t,a,g){this.gymManagementService=t,this.router=a,this.route=g,this.gymId=null,this.loading=!1,this.error=null,this.users=[],this.DateUtils=u.E}ngOnInit(){this.gymId=this.route.snapshot.queryParamMap.get("gymId"),this.gymId||(this.gymId=localStorage.getItem("gymId"))}ionViewWillEnter(){this.gymId?this.fetchAllUsers():this.router.navigate(["/settings"])}fetchAllUsers(){this.loading=!0,this.error=null,this.gymManagementService.getAllUsers(this.gymId).subscribe({next:t=>{this.loading=!1,console.log("Fetched Users:",t),this.users=t.map(a=>({userId:a.UserId,name:a.Name,phoneNumber:a.PhoneNumber,email:a.Email,dateOfBirth:a.DateOfBirth,gender:a.Gender,address:a.Address,emergencyContact:a.EmegencyContact,createdDate:a.CreatedDate,expiryDate:a.ExpiryDate,expiresInDays:this.calculateExpiryInDays(a.ExpiryDate)}))},error:t=>{this.loading=!1,this.error="Error fetching users",console.error("Error fetching users:",t)}})}getExpiryStyle(t){return t<0?{color:"red",fontWeight:"bold"}:0===t?{color:"orange",fontWeight:"bold"}:{color:"green",fontWeight:"bold"}}getExpiryStatus(t){return t>0?`Expires in ${t} days`:0===t?"Expires today":`Expired (${Math.abs(t)} days ago)`}calculateExpiryInDays(t){const a=new Date,E=new Date(t).getTime()-a.getTime();return Math.ceil(E/864e5)}openUserDetails(t){this.router.navigate(["/register-user"],{queryParams:{gymId:this.gymId},state:{user:t}})}}return(r=s).\u0275fac=function(t){return new(t||r)(e.rXU(m.q),e.rXU(d.Ix),e.rXU(d.nX))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-dashboard"]],decls:11,vars:3,consts:[["slot","start"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["color","danger"],[3,"click"],[3,"ngStyle"]],template:function(t,a){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Dashboard"),e.k0s()()(),e.j41(6,"ion-content"),e.DNE(7,f,1,0,"ion-spinner",1)(8,p,4,1,"ion-card",1),e.j41(9,"ion-list"),e.DNE(10,y,8,4,"ion-item",2),e.k0s()()),2&t&&(e.R7$(7),e.Y8G("ngIf",a.loading),e.R7$(),e.Y8G("ngIf",a.error),e.R7$(2),e.Y8G("ngForOf",a.users))},dependencies:[l.Sq,l.bT,l.B3,o.QW,o.b_,o.I9,o.W9,o.eU,o.uz,o.he,o.nf,o.w2,o.IO,o.BC,o.ai,o.el]}),s})()}];let b=(()=>{var r;class s{}return(r=s).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[d.iI.forChild(D),d.iI]}),s})(),I=(()=>{var r;class s{}return(r=s).\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.$C({type:r}),r.\u0275inj=e.G2t({imports:[l.MD,h.YN,o.bv,b]}),s})()}}]);